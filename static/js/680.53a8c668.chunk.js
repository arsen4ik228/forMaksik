"use strict";(self.webpackChunkgood_management=self.webpackChunkgood_management||[]).push([[680],{9680:(e,a,n)=>{n.r(a),n.d(a,{default:()=>_});var t=n(5043);const s={contact:"Chat_contact__fBf8L",header:"Chat_header__SIghd",headerName:"Chat_headerName__Fx73I",search:"Chat_search__IA5WV",main:"Chat_main__GwBIV",btnPomoshnik:"Chat_btnPomoshnik__Hn+yt",btnAddUser:"Chat_btnAddUser__y4aTJ"};var i=n(8224);const o=n.p+"static/media/burger.2a345f899c7f94ac1b78dbdca7e7e145.svg",r={section:"Section_section__WhS9l",name:"Section_name__4KcuY",block:"Section_block__qcV4d",icon:"Section_icon__l9Zw3",row:"Section_row__3H1wG",row_active:"Section_row_active__517lR",controlPanel:"Section_controlPanel__6SQh6",line:"Section_line__++KKp"};var l=n(3003),c=n(6908),d=n(8877),L=n(3216),h=n(579);function v(){const e=(0,l.wA)(),a=(0,L.Zp)(),{organizations:n,isLoadingOrganization:t,isErrorOrganization:s}=(0,d.wL)(),{reduxSelectedOrganizationId:i}=(0,d.RA)(),o=()=>{a("/controlPanel")};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:r.section,children:(0,h.jsx)("div",{className:r.name,children:(0,h.jsx)("span",{children:"\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438"})})}),(0,h.jsxs)("div",{className:r.block,children:[n.map((a=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:`${r.row} ${i===a.id?r.row_active:""}`,onClick:()=>{return n=a.id,t=a.organizationName,s=a.reportDay,localStorage.setItem("selectedOrganizationId",n),localStorage.setItem("name",t),localStorage.setItem("reportDay",s),e((0,c.iC)(n)),void e((0,c.DS)(s));var n,t,s},children:[(0,h.jsx)("svg",{className:r.icon,width:"25",height:"25",children:(0,h.jsx)("path",{d:"M19.66 15.5L17.58 15.5L17.58 17.58L19.66 17.58L19.66 15.5ZM19.66 11.33L17.58 11.33L17.58 13.41L19.66 13.41L19.66 11.33ZM21.75 19.66L13.41 19.66L13.41 17.58L15.5 17.58L15.5 15.5L13.41 15.5L13.41 13.41L15.5 13.41L15.5 11.33L13.41 11.33L13.41 9.25L21.75 9.25L21.75 19.66ZM11.33 7.16L9.25 7.16L9.25 5.08L11.33 5.08L11.33 7.16ZM11.33 11.33L9.25 11.33L9.25 9.25L11.33 9.25L11.33 11.33ZM11.33 15.5L9.25 15.5L9.25 13.41L11.33 13.41L11.33 15.5ZM11.33 19.66L9.25 19.66L9.25 17.58L11.33 17.58L11.33 19.66ZM7.16 7.16L5.08 7.16L5.08 5.08L7.16 5.08L7.16 7.16ZM7.16 11.33L5.08 11.33L5.08 9.25L7.16 9.25L7.16 11.33ZM7.16 15.5L5.08 15.5L5.08 13.41L7.16 13.41L7.16 15.5ZM7.16 19.66L5.08 19.66L5.08 17.58L7.16 17.58L7.16 19.66ZM13.41 7.16L13.41 3L3 3L3 21.75L23.83 21.75L23.83 7.16L13.41 7.16Z"})}),(0,h.jsx)("span",{children:a.organizationName})]},a.id),i===a.id&&(0,h.jsxs)("div",{className:r.controlPanel,onClick:o,children:[(0,h.jsx)("svg",{viewBox:"0 0 24 24",children:(0,h.jsx)("path",{d:"M14.33 11.39L13.93 10.52L13.07 10.13C12.6 9.91 12.6 9.25 13.07 9.03L13.93 8.64L14.33 7.79C14.54 7.32 15.2 7.32 15.42 7.79L15.81 8.65L16.67 9.05C17.13 9.26 17.13 9.92 16.67 10.14L15.8 10.53L15.41 11.39C15.2 11.85 14.53 11.85 14.33 11.39ZM4.61 13.79L5 12.92L5.87 12.53C6.33 12.31 6.33 11.65 5.87 11.43L5 11.05L4.61 10.19C4.4 9.72 3.73 9.72 3.53 10.19L3.13 11.05L2.27 11.45C1.8 11.65 1.8 12.32 2.27 12.53L3.13 12.92L3.53 13.79C3.73 14.25 4.4 14.25 4.61 13.79ZM8.81 8.99L9.39 7.71L10.67 7.13C11.13 6.91 11.13 6.25 10.67 6.03L9.39 5.46L8.81 4.19C8.6 3.72 7.93 3.72 7.73 4.19L7.14 5.46L5.87 6.05C5.4 6.25 5.4 6.92 5.87 7.13L7.14 7.71L7.73 8.99C7.93 9.45 8.6 9.45 8.81 8.99ZM21.99 8.99C21.62 8.65 21.06 8.69 20.72 9.06L14.59 15.96L11.52 12.89C11.05 12.42 10.29 12.42 9.83 12.89L4.11 18.61C3.77 18.96 3.77 19.53 4.11 19.88C4.46 20.23 5.04 20.23 5.39 19.88L10.67 14.59L13.76 17.69C14.25 18.18 15.05 18.15 15.5 17.64L22.07 10.26C22.4 9.89 22.37 9.31 21.99 8.99Z",fillRule:"nonzero"})}),(0,h.jsx)("span",{children:"\u041f\u0430\u043d\u0435\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f"})]})]}))),(0,h.jsx)("div",{className:r.line})]})]})}var m=n(143),u=n(9542),C=n(3891);n(135);function _(){const e=(0,L.Zp)(),{allChats:a,refetchAllChats:n}=(0,d.es)(),[r,l]=(0,t.useState)(),[c,_]=(0,t.useState)(new Map),x=(0,t.useMemo)((()=>["convertCreationEvent","messageCountEvent"]),[]),j=(0,t.useCallback)(((e,a)=>{console.log(`Data from ${e}:`,a)}),[]),p=(0,u.FO)(x,j);return(0,t.useEffect)((()=>{(0,C.z2)(null===p||void 0===p?void 0:p.convertCreationEvent)&&n()}),[null===p||void 0===p?void 0:p.convertCreationEvent]),(0,t.useEffect)((()=>{if(!(0,C.z2)(null===p||void 0===p?void 0:p.messageCountEvent))return;const e=p.messageCountEvent,a=(0,C.Pl)(e.host,e.lastPostInConvert),n=new Map(c);n.has(a.toString())?n.set(a.toString(),n.get(a.toString())+1):n.set(a.toString(),1),l(g(r,a)),_(n)}),[null===p||void 0===p?void 0:p.messageCountEvent]),(0,t.useEffect)((()=>{(0,C.z2)(a)&&l([...a])}),[a]),(0,h.jsxs)("div",{className:s.contact,children:[(0,h.jsxs)("div",{className:s.header,children:[(0,h.jsx)("div",{className:s.headerName,children:"\u043a\u043e\u043d\u0442\u0430\u043a\u0442\u044b"}),(0,h.jsx)("img",{src:o,alt:"burger"})]}),(0,h.jsx)("div",{className:s.search,children:(0,h.jsx)("input",{type:"search",placeholder:"\u043f\u043e\u0438\u0441\u043a"})}),(0,h.jsxs)("div",{className:s.main,children:[(0,h.jsxs)("button",{className:s.btnPomoshnik,onClick:()=>{e("/pomoshnik/start")},children:[(0,h.jsx)("img",{src:i.A,alt:"iconHeader"}),(0,h.jsx)("span",{children:"\u041b\u0438\u0447\u043d\u044b\u0439 \u043f\u043e\u043c\u043e\u0449\u043d\u0438\u043a"})]}),(0,h.jsx)(v,{}),(0,h.jsx)("div",{children:null===r||void 0===r?void 0:r.map(((a,n)=>(0,h.jsx)("div",{onClick:()=>(a=>{e(`/Chat/${a.id}`)})(a),children:(0,h.jsx)(t.Fragment,{children:(0,h.jsx)(m.U,{postName:null===a||void 0===a?void 0:a.postName,userName:(null===a||void 0===a?void 0:a.userFirstName)+" "+(null===a||void 0===a?void 0:a.userLastName),avatarUrl:null===a||void 0===a?void 0:a.userAvatar,unseenMessagesCount:+(null===a||void 0===a?void 0:a.unseenMessagesCount)+ +(null===a||void 0===a?void 0:a.watcherUnseenCount)+(+c.get(null===a||void 0===a?void 0:a.id)||0)})},n)})))}),(0,h.jsx)("button",{onClick:()=>{e("/user")},className:s.btnAddUser,children:(0,h.jsx)("span",{children:" \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f "})})]})]})}const g=(e,a)=>{if(!e)return[];const n=[...e.map((e=>({...e,latestMessageCreatedAt:new Date(e.latestMessageCreatedAt)}))).map((e=>e.id===a?{...e,latestMessageCreatedAt:new Date}:e))].sort(((e,a)=>a.latestMessageCreatedAt-e.latestMessageCreatedAt));return console.warn(n),n}}}]);
//# sourceMappingURL=680.53a8c668.chunk.js.map